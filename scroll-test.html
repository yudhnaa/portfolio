<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Scroll Test</title>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			.navbar {
				position: fixed;
				top: 0;
				width: 100%;
				height: 70px;
				background: rgba(255, 255, 255, 0.9);
				backdrop-filter: blur(10px);
				display: flex;
				justify-content: center;
				align-items: center;
				z-index: 1000;
				border-bottom: 1px solid #eee;
			}

			.nav-menu {
				display: flex;
				list-style: none;
				gap: 2rem;
			}

			.nav-link {
				text-decoration: none;
				color: #333;
				padding: 0.5rem 1rem;
				border-radius: 5px;
				transition: all 0.3s ease;
			}

			.nav-link.active {
				background: #007bff;
				color: white;
			}

			section {
				padding: 80px 20px;
				min-height: 500px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 2rem;
				font-weight: bold;
			}

			#home {
				background: #ffebee;
			}
			#experience {
				background: #e3f2fd;
			}
			#projects {
				background: #e8f5e8;
			}
			#skills {
				background: #fff3e0;
			}
			#contact {
				background: #f3e5f5;
			}

			.debug-info {
				position: fixed;
				top: 80px;
				right: 20px;
				background: rgba(0, 0, 0, 0.8);
				color: white;
				padding: 10px;
				border-radius: 5px;
				z-index: 999;
			}
		</style>
	</head>
	<body>
		<nav class="navbar">
			<ul class="nav-menu">
				<li><a href="#home" class="nav-link">Home</a></li>
				<li><a href="#experience" class="nav-link">Experience</a></li>
				<li><a href="#projects" class="nav-link">Projects</a></li>
				<li><a href="#skills" class="nav-link">Skills</a></li>
				<li><a href="#contact" class="nav-link">Contact</a></li>
			</ul>
		</nav>

		<div class="debug-info">
			<div>Scroll: <span id="scrollY">0</span></div>
			<div>Active: <span id="activeSection">none</span></div>
		</div>

		<section id="home">HOME SECTION</section>
		<section id="experience">EXPERIENCE SECTION</section>
		<section id="projects">PROJECTS SECTION</section>
		<section id="skills">SKILLS SECTION</section>
		<section id="contact">CONTACT SECTION</section>

		<script>
			// Smooth scrolling
			document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
				anchor.addEventListener("click", function (e) {
					e.preventDefault();
					const target = document.querySelector(this.getAttribute("href"));
					if (target) {
						const headerOffset = 70;
						const elementPosition = target.getBoundingClientRect().top;
						const offsetPosition =
							elementPosition + window.pageYOffset - headerOffset;

						window.scrollTo({
							top: offsetPosition,
							behavior: "smooth",
						});
					}
				});
			});

			// Active section highlighting
			function updateActiveNavLink() {
				const sections = document.querySelectorAll("section[id]");
				const navLinks = document.querySelectorAll(".nav-link");

				let currentSection = "";
				const scrollY = window.scrollY;
				const windowHeight = window.innerHeight;
				const documentHeight = document.documentElement.scrollHeight;
				const headerOffset = 70;

				// Check if user is at the bottom of the page
				const isAtBottom = scrollY + windowHeight >= documentHeight - 50;

				if (isAtBottom) {
					const lastSection = sections[sections.length - 1];
					currentSection = lastSection.getAttribute("id");
				} else {
					// Create an array of sections with their positions
					const sectionData = Array.from(sections).map((section) => {
						const rect = section.getBoundingClientRect();
						const sectionTop = rect.top + scrollY;
						const sectionBottom = sectionTop + rect.height;
						const sectionId = section.getAttribute("id");

						return {
							id: sectionId,
							top: sectionTop,
							bottom: sectionBottom,
							element: section,
						};
					});

					// Sort sections by their position
					sectionData.sort((a, b) => a.top - b.top);

					// Find the active section
					for (let i = 0; i < sectionData.length; i++) {
						const section = sectionData[i];
						const nextSection = sectionData[i + 1];

						const sectionStart = section.top - headerOffset;
						const sectionEnd = nextSection
							? nextSection.top - headerOffset
							: Infinity;

						if (scrollY >= sectionStart && scrollY < sectionEnd) {
							currentSection = section.id;
							break;
						}
					}

					// Fallback
					if (!currentSection) {
						for (let i = sectionData.length - 1; i >= 0; i--) {
							if (scrollY >= sectionData[i].top - headerOffset) {
								currentSection = sectionData[i].id;
								break;
							}
						}
					}
				}

				// Update debug info
				document.getElementById("scrollY").textContent = Math.round(scrollY);
				document.getElementById("activeSection").textContent =
					currentSection || "none";

				// Remove active class from all nav links
				navLinks.forEach((link) => link.classList.remove("active"));

				// Add active class to current section's nav link
				if (currentSection) {
					const activeLink = document.querySelector(
						`.nav-link[href="#${currentSection}"]`
					);
					if (activeLink) {
						activeLink.classList.add("active");
					}
				}
			}

			// Attach scroll listener
			window.addEventListener("scroll", updateActiveNavLink);
			updateActiveNavLink(); // Initial call
		</script>
	</body>
</html>
